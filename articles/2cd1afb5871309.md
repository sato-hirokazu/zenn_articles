---
title: "Amazon ECS Express Modeで本番投入を最短化する"
emoji: "🐈"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["AWS", "ECS", "コンテナ"]
published: true
---

## Amazon ECS Express Mode とは

AWS が 2025 年 11 月に発表した Amazon ECS Express Mode は、ロードバランサーやネットワーク、スケーリング、ドメイン設定といったインフラ構築を単一の画面とコマンドにまとめた新しいデプロイ体験だ。[AWS Blog](https://aws.amazon.com/jp/blogs/aws/build-production-ready-applications-without-infrastructure-complexity-using-amazon-ecs-express-mode/) のデモでは Python/Flask アプリを題材に、ECR イメージ URI と IAM ロールを指定するだけで、Fargate サービス、ALB、セキュリティグループ、Route 53 ドメインまで自動で揃う流れが紹介されている。

Express Mode は以下のリソースを一括で構築する。

- Fargate ベースの ECS サービスとクラスター
- 共有可能な Application Load Balancer（ヘルスチェック付き）
- CPU 利用率に基づくオートスケーリングポリシー
- VPC・サブネット・セキュリティグループ
- Route 53 ドメインと HTTPS 対応 URL
- CloudWatch Logs へのログ転送設定

従来は手作業で決める必要があった設定群がテンプレート化されるため、最短で本番レディな環境を得られる。

## Express Mode と従来フローの比較

| 項目 | 従来の ECS 構築 | Express Mode |
| --- | --- | --- |
| クラスター/サービス定義 | 個別に作成し紐付け | ウィザードがまとめて生成 |
| ALB | 別途作成・ターゲット登録 | 自動生成し最大 25 サービスで共有 |
| スケーリング | Application Auto Scaling を個別設定 | CPU メトリクスのポリシーが初期状態で適用 |
| ネットワーク | VPC/サブネット/SG を設計 | ベストプラクティス構成を自動適用 |
| ログ | タスク定義での追加作業が必要 | CloudWatch Logs 連携を UI から指定 |
| ドメイン | Route 53・ACM を手動設定 | HTTPS URL を自動発行 |

初回デプロイが圧倒的に速くなるだけでなく、Infrastructure as Code を書く前の叩き台としても利用できる。

## コンソールからのセットアップ手順

1. **Express Mode ページで Create**: ECR イメージ URI、タスク実行ロール、インフラロールを入力。ロールが無ければ UI で新規作成可能。
2. **Additional configurations**: クラスター名、コンテナポート、ヘルスチェックパス、環境変数、CPU/メモリ、希望タスク数、スケーリング閾値などを調整。
3. **ログ/監視**: CloudWatch Logs の出力先を指定し、必要に応じて新しいロググループを作成。
4. **Create 実行**: Timeline View で VPC や ALB など各リソースの作成状況を追跡。完了後は自動で払い出される URL から即アクセスして動作確認。

これだけで ALB から Route 53 まで揃うため、数分で本番相当の構成を得られる。

## AWS CLI でのデプロイ/更新

Express Mode のワークフローは CLI でも呼び出せる。CI/CD から使う場合は次のようなワンライナーにまとめられる。

```bash
aws ecs create-express-gateway-service \
  --image <account>.dkr.ecr.<region>.amazonaws.com/myapp:latest \
  --execution-role-arn arn:aws:iam::<account>:role/<TaskExecRole> \
  --infrastructure-role-arn arn:aws:iam::<account>:role/<InfraRole>
```

更新も新しいイメージ URI を指定するだけでローリングデプロイが走る。

```bash
aws ecs update-express-gateway-service \
  --service-arn arn:aws:ecs:<region>:<account>:service/<cluster>/<service> \
  --primary-container '{"image": "<new-image-uri>"}'
```

コマンド単位で ALB やスケーリング設定まで含むスタックを扱える点が大きい。[[AWS Blog]](https://aws.amazon.com/jp/blogs/aws/build-production-ready-applications-without-infrastructure-complexity-using-amazon-ecs-express-mode/)

## 運用と拡張のヒント

- **CloudWatch Logs をデフォルトで有効化**: 初期からログ設計をしておくと、障害調査や分析がスムーズ。
- **ALB 共有ルールを整理**: Express Mode の ALB はホストヘッダーでルーティングするため、Route 53 の CNAME/ALIAS 設計も合わせて管理する。
- **スケーリング見直し**: デフォルトが CPU 指標なので、メモリやカスタムメトリクスが重要な場合は Application Auto Scaling を後から調整。
- **IaC との橋渡し**: CloudFormation/CDK/Terraform から Express Mode リソースを管理でき、PoC で得た構成を IaC に引き継げる。
- **コスト管理**: Express Mode 自体の追加料金はなく、作成されたリソースの従量課金のみ。タグを付けておくとコストトラッキングが容易。

## 活用シナリオ

- **少人数チームやスタートアップ**: SRE 不在でもベストプラクティス構成を短時間で用意できる。
- **PoC〜α 版リリース**: 立ち上げを最速化し、要件が増えたら通常の ECS サービスへ段階的に移行。
- **複数サービスの低コスト運用**: ALB 共有でコストを抑えつつ、各サービスにホスト名を割り当てたいケース。
- **学習用途**: 自動生成されたリソースを後から観察し、ECS × Fargate × ALB の関係を俯瞰できる。

## まとめ

Amazon ECS Express Mode は、本番運用レベルの ECS サービスを数分で立ち上げるためのスタートラインを提供する。インフラ設定の山を AWS が肩代わりし、開発者はアプリ価値とデリバリーに集中できる。コンソール/CLI 双方に対応し、Route 53 ドメインや CloudWatch Logs まで含んだフルスタックを自動構築できるため、これからの ECS デプロイのデフォルト手段になり得ると感じた。[[AWS Blog]](https://aws.amazon.com/jp/blogs/aws/build-production-ready-applications-without-infrastructure-complexity-using-amazon-ecs-express-mode/)
